{% extends 'base.html' %}
{% load static %}
{% load humanize %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'css/admin_dashboard.css' %}">
{% endblock %}

{% block title %}Placement Dashboard{% endblock %}

{% block content %}
<div class="admin-dashboard">
    <div class="row my-4 ms-1">
        <div class="col-md-12">
            <h2>Hey, {{ user.name }}!</h2>
            <p>Here's an overview of the current placement status.</p>
        </div>
    </div>

    <div class="stats-overview">
        <div class="stat-card">
            <div class="stat-header">
                <i class="fas fa-users stat-icon"></i>
                <h3 class="stat-title">Total Placement Pool</h3>
            </div>
            <p class="stat-value">{{ total_placement_pool }}</p>
        </div>
        <div class="stat-card">
            <div class="stat-header">
                <i class="fas fa-search stat-icon"></i>
                <h3 class="stat-title">Actively Seeking</h3>
            </div>
            <p class="stat-value">{{ actively_seeking }}</p>
        </div>
        <div class="stat-card">
            <div class="stat-header">
                <i class="fas fa-user-check stat-icon"></i>
                <h3 class="stat-title">Total Placed</h3>
            </div>
            <p class="stat-value">{{ total_placed }}</p>
        </div>
        <div class="stat-card">
            <div class="stat-header">
                <i class="fas fa-chart-line stat-icon"></i>
                <h3 class="stat-title">Placement Rate</h3>
            </div>
            <p class="stat-value">{{ placement_rate }}%</p>
        </div>
        <div class="stat-card">
            <div class="stat-header">
                <i class="fas fa-building stat-icon"></i>
                <h3 class="stat-title">Active Drives</h3>
            </div>
            <p class="stat-value">{{ active_drives_count }}</p>
        </div>
        <div class="stat-card">
            <div class="stat-header">
                <i class="fas fa-calendar-check stat-icon"></i>
                <h3 class="stat-title">Interviews Scheduled</h3>
            </div>
            <p class="stat-value">{{ interviews_scheduled }}</p>
        </div>
    </div>

    <div class="row mt-4">
        <div class="col-md-12">
            <div class="card">
                <div class="card-header">
                    <h4>Upcoming Interviews</h4>
                </div>
                <div class="card-body table-responsive">
                    <table class="table table-hover">
                        <thead>
                            <tr>
                                <th>Student</th>
                                <th>Company</th>
                                <th>Date</th>
                                <th>Time</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for interview in upcoming_interviews %}
                            <tr>
                                <td>{{ interview.placement.student.first_name }} {{ interview.placement.student.last_name }}</td>
                                <td>{{ interview.company.company_name }}</td>
                                <td>{{ interview.interview_date|date:"d M Y" }}</td>
                                <td>{{ interview.interview_time|time:"H:i" }}</td>
                            </tr>
                            {% empty %}
                            <tr><td colspan="4">No upcoming interviews.</td></tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>

    <div class="row mt-4">
        <div class="col-md-12">
            <div class="card">
                <div class="card-header">
                    <h4>Students Yet to be Placed</h4>
                </div>
                <div class="card-body table-responsive">
                    <table class="table table-hover">
                        <thead>
                            <tr>
                                <th>Student ID</th>
                                <th>Name</th>
                                <th>Course</th>
                                <th>Course Status</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for placement in students_yet_to_be_placed %}
                            <tr>
                                <td>{{ placement.student.student_id }}</td>
                                <td>{{ placement.student.first_name }} {{ placement.student.last_name }}</td>
                                <td>{{ placement.student.course.name|default:"-" }}</td>
                                <td>{{ placement.student.get_course_status_display }}</td>
                            </tr>
                            {% empty %}
                            <tr><td colspan="4">No students are currently seeking placement.</td></tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>

    <div class="row mt-4">
        <div class="col-md-12">
            <div class="card">
                <div class="card-header">
                    <h4>Recently Placed Students</h4>
                </div>
                <div class="card-body table-responsive">
                    <table class="table table-hover">
                        <thead>
                            <tr>
                                <th>Student ID</th>
                                <th>Name</th>
                                <th>Course</th>
                                <th>Course End Date</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for student in recently_placed %}
                            <tr>
                                <td>{{ student.student_id }}</td>
                                <td>{{ student.first_name }} {{ student.last_name }}</td>
                                <td>{{ student.course.name|default:"-" }}</td>
                                <td>{{ student.end_date|date:"d M Y" }}</td>
                            </tr>
                            {% empty %}
                            <tr><td colspan="4">No students have been placed recently.</td></tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>

</div>
{% endblock %}